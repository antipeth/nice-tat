---
layout: ../../../../layouts/Layout.astro
title: 四.网络层
---

# 网络层概述

网络层的主要任务是**实现网络互连**，进而**实现数据包在各网络之间的传输**。

要实现网络层任务，需要解决以下主要问题:

- 网络层向运输层提供怎样的服务（“可靠传输”还是“不可靠传输”）

- 网络层寻址问题

- 路由选择问题

**因特网**(Internet)是目前全世界用户数量最多的互联网，它使用**TCP/IP协议栈**。

由于TCP/IP协议栈的网络层使用**网际协议IP**，它是整个协议栈的核心协议，因此在TCP/IP协议栈中网络层常称为**网际层**。

综上所述，我们通过学习TCP/IP协议栈的网际层来学习网络层的理论知识和实践技术。

![](https://img.0pt.im/computernet/4-1/4-1-1.png)


# 数据报的发送和转发过程

IP数据报的发送和转发过程包含以下两部分:

- 主机发送IP数据报

- 路由器转发IP数据报

为了将重点放在TCP/IP协议栈的网际层发送和转发IP数据报的过程上，在之后的举例中，我们**忽略使用ARP协议来获取目的主机或路由器接口的MAC地址的过程以及以太网交换机自学习和转发帧的过程**。

举例：

![](https://img.0pt.im/computernet/4-4/4-4-1.png)

假设C要发送数据给F，源主机如何知道目的主机是否与自己在同一个网络中？通过想与运算。

![](https://img.0pt.im/computernet/4-4/4-4-2.png)

C怎么知道R的存在？

![](https://img.0pt.im/computernet/4-4/4-4-3.png)

指定默认网关。

假设A发送数据给D

![](https://img.0pt.im/computernet/4-4/4-4-4.png)

路由器是如何转发呢？

- 检查lP数据报首部是否出错:若出错，则直接丢弃该lIP数据报并通告源主机若没有出错，则进行转发

- 根据lP数据报的目的地址在路由表中查找匹配的条目:若找到匹配的条目，则转发给条目中指示的下一跳若找不到，则丢弃该lP数据报并通告源主机

![](https://img.0pt.im/computernet/4-4/4-4-5.png)

将目的地址与目的网络相应的地址掩码进行相与，得到的结果为目的网络，即匹配。

> 路由器隔离广播域，就算广播数据报的目的地址为其他网络，也不转发。

例题：下列网络设备中，能够抑制广播风暴的是

1中继器  2集线器  3网桥  4路由器

A.仅1和2  B.仅3  C.仅3和4  D.仅4

解析：

中继器和集线器工作在物理层，既不隔离冲突域也不隔离广播域。

网桥和交换机(多端口网桥）工作在数据链路层，可以隔离冲突域，不能隔离广播域。

路由器工作在网络层，既隔离冲突域，也隔离广播域。

选D

例题：下列关于IP路由器概念的描述中，正确的是

1运行路由协议，设置路由表

2监测到拥塞时，合理丢弃IP分组

3对收到的IP分组头进行差错校验，确保传输的IP分组不丢失

4根据收到的IP分组的目的IP地址，将其转发到合适的输出线路上

A.仅34    B.仅123    C.仅124    D.1234

解析：

IP路由器工作在TCP/IP体系结构的网际层(或称IP层)，TCP/IP体系结构的网际层并不负责可靠传输，也就是不能确保传输的IP分组不丢失。

IP路由器对收到的lP分组头进行差错校验，当发现错误时会丢弃该IP分组并向源主机发送ICMP差错报告报文(类型为参数错误)。

综上所述，题目中的描述ⅢI是错误的，利用排除法可知选项C正确。题目中的其他描述项都是正确的。

例题：

某网络拓扑如下图所示，其中路由器内网接口、DHCP服务器、WWW服务器与主机1均采用静态IP地址配置，相关地址信息见图中标注;主机2~主机N通过DHCP服务器动态获取IP地址等配置信息。

若主机1的子网掩码和默认网关分别配置为255.255.255.0和111.123.15.2，则该主机是否能访问WWW服务器?是否能访问Internet?请说明理由。

![](https://img.0pt.im/computernet/4-4/4-4-6.png)

解析：主机1可以访问WWW服务器。从IP地址与子网掩码配置以及物理连接方面看，主机1和wwW服务器在同一网络中。

主机1不能访问Internet，因为它的默认网关错误配置成了DHCP服务器的IP地址,DHCP服务器不具备路由器的功能,无法将IP分组转发到Internet。
